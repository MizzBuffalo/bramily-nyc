<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bramily NYC Trip Coordinator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.3);
        }
        
        h1 {
            font-size: 36px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            font-size: 18px;
            opacity: 0.95;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 30px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            color: #fff;
            font-size: 16px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #ccc;
            font-weight: 500;
        }
        
        .required::after {
            content: " *";
            color: #ff6b6b;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #fff;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255,255,255,0.12);
        }
        
        select option {
            background: #2a2a3e;
            color: #fff;
        }
        
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        button {
            padding: 14px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .list-item {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 12px;
            border-left: 4px solid #667eea;
        }
        
        .list-item:hover {
            background: rgba(255,255,255,0.08);
        }
        
        .item-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .item-details {
            font-size: 13px;
            color: #aaa;
            line-height: 1.6;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #aaa;
        }
        
        .section-group {
            margin-bottom: 30px;
        }
        
        .section-header {
            background: rgba(102, 126, 234, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }
        
        .export-btn {
            background: #28a745;
            margin-top: 20px;
        }
        
        .help-text {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
            font-size: 18px;
        }
        
        .refresh-btn {
            background: #17a2b8;
            margin-right: 10px;
        }
        
        .success-message {
            background: rgba(40, 167, 69, 0.2);
            border: 2px solid #28a745;
            color: #28a745;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }
        
        .night-section {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .night-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .hidden {
            display: none;
        }
        
        .datetime-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .match-badge {
            display: inline-block;
            background: rgba(40, 167, 69, 0.3);
            border: 1px solid #28a745;
            color: #28a745;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .time-group-header {
            background: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
            padding: 12px 15px;
            border-radius: 8px;
            margin: 20px 0 10px 0;
            font-weight: 600;
            color: #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé∏ Bramily NYC Trip Coordinator üóΩ</h1>
            <p class="subtitle">Brandi Carlile @ MSG ‚Ä¢ Feb 13-14, 2026</p>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('form')">‚ûï Add Your Info</button>
            <button class="tab-btn" onclick="showTab('seating')">üé≠ Seating</button>
            <button class="tab-btn" onclick="showTab('hotels')">üè® Hotels</button>
            <button class="tab-btn" onclick="showTab('rideshare')">üöó Rideshare</button>
            <button class="tab-btn" onclick="showTab('directory')">üìã Directory</button>
        </div>
        
        <!-- ADD INFO TAB -->
        <div id="form" class="tab-content active">
            <div class="card">
                <h2>Add Your Trip Information</h2>
                
                <div id="successMessage" class="success-message" style="display: none;">
                    ‚ú® Successfully added! Check the other tabs to see everyone!
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">Your Name</label>
                        <input type="text" id="name" placeholder="Enter your name">
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Contact Info</label>
                        <input type="text" id="contact" placeholder="Email, phone, or Instagram">
                        <div class="help-text">So people can reach you!</div>
                    </div>
                </div>
                
                <h3 style="color: #667eea; margin: 30px 0 15px 0;">Concert Info</h3>
                
                <div class="form-group">
                    <label class="required">Which Night(s)?</label>
                    <select id="nightSelection" onchange="updateNightFields()">
                        <option value="">-- Select Night --</option>
                        <option value="friday">Friday 2/13 only</option>
                        <option value="saturday">Saturday 2/14 only</option>
                        <option value="both">Both nights! üéâ</option>
                    </select>
                </div>
                
                <!-- FRIDAY NIGHT SECTION -->
                <div id="fridaySection" class="night-section hidden">
                    <h3>üé∏ Friday, February 13</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="required">Section</label>
                            <input type="text" id="fridaySection" placeholder="e.g., 116, A, 201, 310">
                            <div class="help-text">Letters (A-F) or numbers</div>
                        </div>
                        
                        <div class="form-group">
                            <label>Row</label>
                            <input type="text" id="fridayRow" placeholder="If you know it">
                        </div>
                        
                        <div class="form-group">
                            <label>Seat</label>
                            <input type="text" id="fridaySeat" placeholder="If you know it">
                        </div>
                        
                        <div class="form-group">
                            <label>VIP Package</label>
                            <select id="fridayVIP">
                                <option value="none">None (regular ticket)</option>
                                <option value="soundcheck">Soundcheck Only</option>
                                <option value="bignight">Big Night Out</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- SATURDAY NIGHT SECTION -->
                <div id="saturdaySection" class="night-section hidden">
                    <h3>üé∏ Saturday, February 14</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="required">Section</label>
                            <input type="text" id="saturdaySection" placeholder="e.g., 116, A, 201, 310">
                            <div class="help-text">Letters (A-F) or numbers</div>
                        </div>
                        
                        <div class="form-group">
                            <label>Row</label>
                            <input type="text" id="saturdayRow" placeholder="If you know it">
                        </div>
                        
                        <div class="form-group">
                            <label>Seat</label>
                            <input type="text" id="saturdaySeat" placeholder="If you know it">
                        </div>
                        
                        <div class="form-group">
                            <label>VIP Package</label>
                            <select id="saturdayVIP">
                                <option value="none">None (regular ticket)</option>
                                <option value="soundcheck">Soundcheck Only</option>
                                <option value="bignight">Big Night Out</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <h3 style="color: #667eea; margin: 30px 0 15px 0;">Hotel Info</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="required">Where Are You Staying?</label>
                        <select id="hotel">
                            <option value="">-- Select Hotel --</option>
                            <option value="springhill">SpringHill Suites by Marriott</option>
                            <option value="courtyard">Courtyard by Marriott</option>
                            <option value="other">Other hotel</option>
                            <option value="none">Not staying overnight</option>
                            <option value="friends">Staying with friends/family</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Other Hotel Name</label>
                        <input type="text" id="otherHotel" placeholder="If you selected 'Other'">
                    </div>
                    
                    <div class="form-group">
                        <label>Check-in Date</label>
                        <input type="date" id="checkin">
                    </div>
                    
                    <div class="form-group">
                        <label>Check-out Date</label>
                        <input type="date" id="checkout">
                    </div>
                </div>
                
                <h3 style="color: #667eea; margin: 30px 0 15px 0;">Airport Rideshare (Uber/Lyft splitting)</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Interested in Sharing Rides?</label>
                        <select id="rideshare">
                            <option value="no">No thanks</option>
                            <option value="offering">Yes - I can coordinate a shared ride üöó</option>
                            <option value="looking">Yes - Looking to join a shared ride üôã</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Which Airport?</label>
                        <select id="airport">
                            <option value="">-- Select Airport --</option>
                            <option value="jfk">JFK (John F. Kennedy)</option>
                            <option value="lga">LaGuardia (LGA)</option>
                            <option value="ewr">Newark (EWR)</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Arrival Date & Time</label>
                    <div class="datetime-group">
                        <input type="date" id="arrivalDate" placeholder="Arrival date">
                        <input type="time" id="arrivalTime" placeholder="Arrival time">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Departure Date & Time</label>
                    <div class="datetime-group">
                        <input type="date" id="departureDate" placeholder="Departure date">
                        <input type="time" id="departureTime" placeholder="Departure time">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Additional Notes</label>
                    <textarea id="notes" placeholder="Anything else the Bramily should know?"></textarea>
                </div>
                
                <button id="submitBtn" onclick="addPerson()">‚ú® Add Me to the Trip!</button>
            </div>
        </div>
        
        <!-- SEATING TAB -->
        <div id="seating" class="tab-content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="statTotal">0</div>
                    <div class="stat-label">Total People</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statFriday">0</div>
                    <div class="stat-label">Friday Night</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statSaturday">0</div>
                    <div class="stat-label">Saturday Night</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statBoth">0</div>
                    <div class="stat-label">Both Nights</div>
                </div>
            </div>
            
            <div class="card">
                <h2>üé≠ Seating by Night & Section</h2>
                <button class="refresh-btn" onclick="loadData()">üîÑ Refresh Data</button>
                <button class="export-btn" onclick="exportSeating()">üìã Export Seating List</button>
                <div id="seatingList"></div>
            </div>
        </div>
        
        <!-- HOTELS TAB -->
        <div id="hotels" class="tab-content">
            <div class="card">
                <h2>üè® Hotel Groups</h2>
                <button class="refresh-btn" onclick="loadData()">üîÑ Refresh Data</button>
                <button class="export-btn" onclick="exportHotels()">üìã Export Hotel List</button>
                <div id="hotelsList"></div>
            </div>
        </div>
        
        <!-- RIDESHARE TAB -->
        <div id="rideshare" class="tab-content">
            <div class="card">
                <h2>üöó Airport Rideshare Board</h2>
                <p style="color: #aaa; margin-bottom: 20px;">People with similar times are grouped together - easy matching! ‚≠ê</p>
                <button class="refresh-btn" onclick="loadData()">üîÑ Refresh Data</button>
                <button class="export-btn" onclick="exportRideshare()">üìã Export Rideshare List</button>
                <div id="rideshareList"></div>
            </div>
        </div>
        
        <!-- DIRECTORY TAB -->
        <div id="directory" class="tab-content">
            <div class="card">
                <h2>üìã Complete Directory</h2>
                <p style="color: #aaa; margin-bottom: 20px;">Everyone who's added their info - sorted alphabetically</p>
                <button class="refresh-btn" onclick="loadData()">üîÑ Refresh Data</button>
                <button class="export-btn" onclick="exportAll()">üìã Export Complete List</button>
                <div id="directoryList"></div>
            </div>
        </div>
    </div>

    <script>
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbx3UFMN_qf5Q_3Pmugvwdb2OtaZMZsx0BxJvCgE8wmvirIDl6VvuFqERxc-Xb3Kn8ij/exec';
        let people = [];
        
        // Show/hide night sections based on selection
        function updateNightFields() {
            const selection = document.getElementById('nightSelection').value;
            const fridayDiv = document.getElementById('fridaySection');
            const saturdayDiv = document.getElementById('saturdaySection');
            
            fridayDiv.classList.add('hidden');
            saturdayDiv.classList.add('hidden');
            
            if (selection === 'friday' || selection === 'both') {
                fridayDiv.classList.remove('hidden');
            }
            if (selection === 'saturday' || selection === 'both') {
                saturdayDiv.classList.remove('hidden');
            }
        }
        
        // Load data from Google Sheets
        async function loadData() {
            try {
                const response = await fetch(SHEET_URL);
                const data = await response.json();
                people = data.map(row => ({
                    name: row.Name || '',
                    contact: row.Contact || '',
                    nights: row.Nights || '',
                    fridaySection: row.FridaySection || '',
                    fridayRow: row.FridayRow || '',
                    fridaySeat: row.FridaySeat || '',
                    fridayVIP: row.FridayVIP || '',
                    saturdaySection: row.SaturdaySection || '',
                    saturdayRow: row.SaturdayRow || '',
                    saturdaySeat: row.SaturdaySeat || '',
                    saturdayVIP: row.SaturdayVIP || '',
                    hotel: row.Hotel || '',
                    otherHotel: row.OtherHotel || '',
                    checkin: row.CheckIn || '',
                    checkout: row.CheckOut || '',
                    rideshare: row.Rideshare || '',
                    airport: row.Airport || '',
                    arrivalDate: row.ArrivalDate || '',
                    arrivalTime: row.ArrivalTime || '',
                    departureDate: row.DepartureDate || '',
                    departureTime: row.DepartureTime || '',
                    notes: row.Notes || ''
                }));
                render();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }
        
        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            loadData();
        }
        
        // Add person to Google Sheets
        async function addPerson() {
            const nightSelection = document.getElementById('nightSelection').value;
            
            if (!nightSelection) {
                alert('Please select which night(s) you are attending');
                return;
            }
            
            const data = {
                name: document.getElementById('name').value.trim(),
                contact: document.getElementById('contact').value.trim(),
                nights: nightSelection,
                fridaySection: document.getElementById('fridaySection').value.trim().toUpperCase(),
                fridayRow: document.getElementById('fridayRow').value.trim(),
                fridaySeat: document.getElementById('fridaySeat').value.trim(),
                fridayVIP: document.getElementById('fridayVIP').value,
                saturdaySection: document.getElementById('saturdaySection').value.trim().toUpperCase(),
                saturdayRow: document.getElementById('saturdayRow').value.trim(),
                saturdaySeat: document.getElementById('saturdaySeat').value.trim(),
                saturdayVIP: document.getElementById('saturdayVIP').value,
                hotel: document.getElementById('hotel').value,
                otherHotel: document.getElementById('otherHotel').value.trim(),
                checkin: document.getElementById('checkin').value,
                checkout: document.getElementById('checkout').value,
                rideshare: document.getElementById('rideshare').value,
                airport: document.getElementById('airport').value,
                arrivalDate: document.getElementById('arrivalDate').value,
                arrivalTime: document.getElementById('arrivalTime').value,
                departureDate: document.getElementById('departureDate').value,
                departureTime: document.getElementById('departureTime').value,
                notes: document.getElementById('notes').value.trim()
            };
            
            // Validate required fields based on night selection
            if (!data.name || !data.contact || !data.hotel) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }
            
            if ((nightSelection === 'friday' || nightSelection === 'both') && !data.fridaySection) {
                alert('Please enter your Friday section');
                return;
            }
            
            if ((nightSelection === 'saturday' || nightSelection === 'both') && !data.saturdaySection) {
                alert('Please enter your Saturday section');
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Adding...';
            
            try {
                const response = await fetch(SHEET_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                // Clear form
                document.querySelectorAll('input[type="text"], input[type="date"], input[type="time"], textarea').forEach(el => el.value = '');
                document.querySelectorAll('select').forEach(el => el.selectedIndex = 0);
                updateNightFields();
                
                // Show success message
                const successMsg = document.getElementById('successMessage');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 5000);
                
                setTimeout(() => loadData(), 2000);
                
            } catch (error) {
                alert('Error adding to sheet. Please try again.');
                console.error('Error:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = '‚ú® Add Me to the Trip!';
            }
        }
        
        // Render all views
        function render() {
            renderStats();
            renderSeating();
            renderHotels();
            renderRideshare();
            renderDirectory();
        }
        
        function renderStats() {
            const uniquePeople = new Set(people.map(p => p.name));
            document.getElementById('statTotal').textContent = uniquePeople.size;
            document.getElementById('statFriday').textContent = people.filter(p => p.nights === 'friday' || p.nights === 'both').length;
            document.getElementById('statSaturday').textContent = people.filter(p => p.nights === 'saturday' || p.nights === 'both').length;
            document.getElementById('statBoth').textContent = people.filter(p => p.nights === 'both').length;
        }
        
        function renderSeating() {
            let html = '';
            
            // Friday Night
            const fridayPeople = people.filter(p => p.nights === 'friday' || p.nights === 'both');
            if (fridayPeople.length > 0) {
                html += '<div class="section-group"><h3 style="color: #667eea; font-size: 24px; margin-bottom: 20px;">üé∏ Friday, February 13</h3>';
                
                const fridaySections = {};
                fridayPeople.forEach(p => {
                    if (!p.fridaySection) return;
                    if (!fridaySections[p.fridaySection]) fridaySections[p.fridaySection] = [];
                    fridaySections[p.fridaySection].push(p);
                });
                
                Object.keys(fridaySections).sort().forEach(sec => {
                    html += `<div class="section-header">Section ${sec} (${fridaySections[sec].length})</div>`;
                    fridaySections[sec].forEach(p => {
                        const seatInfo = p.fridayRow && p.fridaySeat ? `Row ${p.fridayRow}, Seat ${p.fridaySeat}` : 
                                         p.fridayRow ? `Row ${p.fridayRow}` : 
                                         p.fridaySeat ? `Seat ${p.fridaySeat}` : 'Seat TBD';
                        const vipText = p.fridayVIP === 'soundcheck' ? ' ‚Ä¢ VIP Soundcheck' : 
                                       p.fridayVIP === 'bignight' ? ' ‚Ä¢ VIP Big Night Out' : '';
                        
                        html += `<div class="list-item">
                            <div class="item-name">${p.name}</div>
                            <div class="item-details">${seatInfo}${vipText}<br>üìû ${p.contact}</div>
                        </div>`;
                    });
                });
                html += '</div>';
            }
            
            // Saturday Night
            const saturdayPeople = people.filter(p => p.nights === 'saturday' || p.nights === 'both');
            if (saturdayPeople.length > 0) {
                html += '<div class="section-group"><h3 style="color: #667eea; font-size: 24px; margin-bottom: 20px;">üé∏ Saturday, February 14</h3>';
                
                const saturdaySections = {};
                saturdayPeople.forEach(p => {
                    if (!p.saturdaySection) return;
                    if (!saturdaySections[p.saturdaySection]) saturdaySections[p.saturdaySection] = [];
                    saturdaySections[p.saturdaySection].push(p);
                });
                
                Object.keys(saturdaySections).sort().forEach(sec => {
                    html += `<div class="section-header">Section ${sec} (${saturdaySections[sec].length})</div>`;
                    saturdaySections[sec].forEach(p => {
                        const seatInfo = p.saturdayRow && p.saturdaySeat ? `Row ${p.saturdayRow}, Seat ${p.saturdaySeat}` : 
                                         p.saturdayRow ? `Row ${p.saturdayRow}` : 
                                         p.saturdaySeat ? `Seat ${p.saturdaySeat}` : 'Seat TBD';
                        const vipText = p.saturdayVIP === 'soundcheck' ? ' ‚Ä¢ VIP Soundcheck' : 
                                       p.saturdayVIP === 'bignight' ? ' ‚Ä¢ VIP Big Night Out' : '';
                        
                        html += `<div class="list-item">
                            <div class="item-name">${p.name}</div>
                            <div class="item-details">${seatInfo}${vipText}<br>üìû ${p.contact}</div>
                        </div>`;
                    });
                });
                html += '</div>';
            }
            
            document.getElementById('seatingList').innerHTML = html || '<div class="empty-state">üé≠ No one added yet! Be the first!</div>';
        }
        
        function renderHotels() {
            const hotels = {
                'springhill': [],
                'courtyard': [],
                'other': [],
                'none': [],
                'friends': []
            };
            
            people.forEach(p => {
                if (p.hotel && hotels[p.hotel]) {
                    hotels[p.hotel].push(p);
                }
            });
            
            const hotelNames = {
                'springhill': 'üè® SpringHill Suites by Marriott',
                'courtyard': 'üè® Courtyard by Marriott',
                'other': 'üè® Other Hotels',
                'none': 'üö´ Not Staying Overnight',
                'friends': 'üè† Staying with Friends/Family'
            };
            
            let html = '';
            Object.keys(hotels).forEach(key => {
                if (hotels[key].length === 0) return;
                
                // Group by check-in date within each hotel
                const byCheckin = {};
                hotels[key].forEach(p => {
                    const checkin = p.checkin || 'Date TBD';
                    if (!byCheckin[checkin]) byCheckin[checkin] = [];
                    byCheckin[checkin].push(p);
                });
                
                html += `<div class="section-group">
                    <div class="section-header">${hotelNames[key]} (${hotels[key].length})</div>`;
                
                Object.keys(byCheckin).sort().forEach(checkinDate => {
                    if (Object.keys(byCheckin).length > 1) {
                        html += `<div class="time-group-header">Check-in: ${checkinDate === 'Date TBD' ? checkinDate : new Date(checkinDate).toLocaleDateString()} (${byCheckin[checkinDate].length})</div>`;
                    }
                    
                    byCheckin[checkinDate].forEach(p => {
                        const dates = p.checkin && p.checkout ? 
                            `${new Date(p.checkin).toLocaleDateString()} - ${new Date(p.checkout).toLocaleDateString()}` : 
                            'Dates TBD';
                        const hotelName = p.hotel === 'other' && p.otherHotel ? ` - ${p.otherHotel}` : '';
                        
                        html += `<div class="list-item">
                            <div>
                                <div class="item-name">${p.name}</div>
                                <div class="item-details">üìÖ ${dates}${hotelName}<br>üìû ${p.contact}</div>
                            </div>
                        </div>`;
                    });
                });
                
                html += '</div>';
            });
            
            document.getElementById('hotelsList').innerHTML = html || '<div class="empty-state">üè® No one added hotel info yet!</div>';
        }
        
        function renderRideshare() {
            const rideshareNeeded = people.filter(p => p.rideshare === 'offering' || p.rideshare === 'looking');
            
            if (rideshareNeeded.length === 0) {
                document.getElementById('rideshareList').innerHTML = '<div class="empty-state">üöó No rideshare requests yet!</div>';
                return;
            }
            
            // Group by airport
            const byAirport = {};
            rideshareNeeded.forEach(p => {
                const airport = p.airport || 'TBD';
                if (!byAirport[airport]) byAirport[airport] = { arrivals: [], departures: [] };
                
                if (p.arrivalDate && p.arrivalTime) {
                    byAirport[airport].arrivals.push(p);
                }
                if (p.departureDate && p.departureTime) {
                    byAirport[airport].departures.push(p);
                }
            });
            
            const airportNames = {
                'jfk': '‚úàÔ∏è JFK (John F. Kennedy)',
                'lga': '‚úàÔ∏è LaGuardia (LGA)',
                'ewr': '‚úàÔ∏è Newark (EWR)',
                'other': '‚úàÔ∏è Other Airport',
                'TBD': '‚úàÔ∏è Airport TBD'
            };
            
            let html = '';
            
            Object.keys(byAirport).forEach(airport => {
                html += `<div class="section-group"><div class="section-header">${airportNames[airport] || airport.toUpperCase()}</div>`;
                
                // Arrivals
                if (byAirport[airport].arrivals.length > 0) {
                    html += '<h4 style="color: #667eea; margin: 20px 0 15px 0; font-size: 18px;">ARRIVALS</h4>';
                    
                    // Sort by datetime
                    const arrivals = byAirport[airport].arrivals.sort((a, b) => {
                        const aTime = new Date(a.arrivalDate + ' ' + a.arrivalTime);
                        const bTime = new Date(b.arrivalDate + ' ' + b.arrivalTime);
                        return aTime - bTime;
                    });
                    
                    // Group similar times (within 1 hour)
                    const groups = [];
                    arrivals.forEach(p => {
                        const pTime = new Date(p.arrivalDate + ' ' + p.arrivalTime);
                        let added = false;
                        
                        for (let group of groups) {
                            const groupTime = new Date(group[0].arrivalDate + ' ' + group[0].arrivalTime);
                            const diffMinutes = Math.abs(pTime - groupTime) / 60000;
                            
                            if (diffMinutes <= 60) {
                                group.push(p);
                                added = true;
                                break;
                            }
                        }
                        
                        if (!added) {
                            groups.push([p]);
                        }
                    });
                    
                    groups.forEach(group => {
                        if (group.length > 1) {
                            const firstTime = new Date(group[0].arrivalDate + ' ' + group[0].arrivalTime);
                            const lastTime = new Date(group[group.length-1].arrivalDate + ' ' + group[group.length-1].arrivalTime);
                            html += `<div class="time-group-header">‚≠ê GOOD MATCH - ${firstTime.toLocaleDateString()} ${firstTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} - ${lastTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} (${group.length})</div>`;
                        }
                        
                        group.forEach(p => {
                            const datetime = new Date(p.arrivalDate + ' ' + p.arrivalTime);
                            const status = p.rideshare === 'offering' ? 'üöó Offering' : 'üôã Looking';
                            
                            html += `<div class="list-item">
                                <div>
                                    <div class="item-name">${p.name} - ${status}</div>
                                    <div class="item-details">
                                        üìÖ ${datetime.toLocaleDateString()} at ${datetime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}<br>
                                        üìû ${p.contact}
                                    </div>
                                </div>
                            </div>`;
                        });
                    });
                }
                
                // Departures
                if (byAirport[airport].departures.length > 0) {
                    html += '<h4 style="color: #667eea; margin: 20px 0 15px 0; font-size: 18px;">DEPARTURES</h4>';
                    
                    // Sort by datetime
                    const departures = byAirport[airport].departures.sort((a, b) => {
                        const aTime = new Date(a.departureDate + ' ' + a.departureTime);
                        const bTime = new Date(b.departureDate + ' ' + b.departureTime);
                        return aTime - bTime;
                    });
                    
                    // Group similar times (within 1 hour)
                    const groups = [];
                    departures.forEach(p => {
                        const pTime = new Date(p.departureDate + ' ' + p.departureTime);
                        let added = false;
                        
                        for (let group of groups) {
                            const groupTime = new Date(group[0].departureDate + ' ' + group[0].departureTime);
                            const diffMinutes = Math.abs(pTime - groupTime) / 60000;
                            
                            if (diffMinutes <= 60) {
                                group.push(p);
                                added = true;
                                break;
                            }
                        }
                        
                        if (!added) {
                            groups.push([p]);
                        }
                    });
                    
                    groups.forEach(group => {
                        if (group.length > 1) {
                            const firstTime = new Date(group[0].departureDate + ' ' + group[0].departureTime);
                            const lastTime = new Date(group[group.length-1].departureDate + ' ' + group[group.length-1].departureTime);
                            html += `<div class="time-group-header">‚≠ê GOOD MATCH - ${firstTime.toLocaleDateString()} ${firstTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} - ${lastTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} (${group.length})</div>`;
                        }
                        
                        group.forEach(p => {
                            const datetime = new Date(p.departureDate + ' ' + p.departureTime);
                            const status = p.rideshare === 'offering' ? 'üöó Offering' : 'üôã Looking';
                            
                            html += `<div class="list-item">
                                <div>
                                    <div class="item-name">${p.name} - ${status}</div>
                                    <div class="item-details">
                                        üìÖ ${datetime.toLocaleDateString()} at ${datetime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}<br>
                                        üìû ${p.contact}
                                    </div>
                                </div>
                            </div>`;
                        });
                    });
                }
                
                html += '</div>';
            });
            
            document.getElementById('rideshareList').innerHTML = html;
        }
        
        function renderDirectory() {
            let html = '';
            const sorted = [...people].sort((a,b) => (a.name || '').localeCompare(b.name || ''));
            
            sorted.forEach(p => {
                const nightText = p.nights === 'both' ? 'Both nights' : 
                                p.nights === 'friday' ? 'Friday only' : 'Saturday only';
                                
                const hotelText = p.hotel === 'springhill' ? 'SpringHill Suites' : 
                                p.hotel === 'courtyard' ? 'Courtyard' :
                                p.hotel === 'other' ? p.otherHotel || 'Other hotel' :
                                p.hotel === 'friends' ? 'Friends/Family' : 'Not staying';
                
                let seatText = '';
                if (p.nights === 'friday' || p.nights === 'both') {
                    seatText += `Fri: Section ${p.fridaySection} ${p.fridayRow ? 'Row ' + p.fridayRow : ''} ${p.fridaySeat ? 'Seat ' + p.fridaySeat : ''}`;
                    if (p.fridayVIP !== 'none') seatText += ` (VIP: ${p.fridayVIP === 'soundcheck' ? 'Soundcheck' : 'Big Night Out'})`;
                }
                if (p.nights === 'both') seatText += '<br>';
                if (p.nights === 'saturday' || p.nights === 'both') {
                    seatText += `Sat: Section ${p.saturdaySection} ${p.saturdayRow ? 'Row ' + p.saturdayRow : ''} ${p.saturdaySeat ? 'Seat ' + p.saturdaySeat : ''}`;
                    if (p.saturdayVIP !== 'none') seatText += ` (VIP: ${p.saturdayVIP === 'soundcheck' ? 'Soundcheck' : 'Big Night Out'})`;
                }
                
                html += `<div class="list-item">
                    <div>
                        <div class="item-name">${p.name}</div>
                        <div class="item-details">
                            üé≠ ${seatText}<br>
                            üìÖ ${nightText}<br>
                            üè® ${hotelText}<br>
                            üìû ${p.contact}
                            ${p.notes ? '<br>üìù ' + p.notes : ''}
                        </div>
                    </div>
                </div>`;
            });
            
            document.getElementById('directoryList').innerHTML = html || '<div class="empty-state">üìã No one added yet!</div>';
        }
        
        // Export functions (keeping original simple text exports)
        function exportSeating() {
            let text = 'üé∏ BRAMILY NYC - SEATING BY NIGHT & SECTION\n';
            text += 'Brandi Carlile @ MSG ‚Ä¢ Feb 13-14, 2026\n';
            text += '='.repeat(50) + '\n\n';
            
            const fridayPeople = people.filter(p => p.nights === 'friday' || p.nights === 'both');
            if (fridayPeople.length > 0) {
                text += 'FRIDAY, FEBRUARY 13\n' + '='.repeat(50) + '\n\n';
                const fridaySections = {};
                fridayPeople.forEach(p => {
                    if (!p.fridaySection) return;
                    if (!fridaySections[p.fridaySection]) fridaySections[p.fridaySection] = [];
                    fridaySections[p.fridaySection].push(p);
                });
                Object.keys(fridaySections).sort().forEach(sec => {
                    text += `SECTION ${sec}\n` + '-'.repeat(30) + '\n';
                    fridaySections[sec].forEach(p => {
                        const vipText = p.fridayVIP === 'soundcheck' ? ' - VIP Soundcheck' : p.fridayVIP === 'bignight' ? ' - VIP Big Night Out' : '';
                        text += `${p.name} - Row ${p.fridayRow || '?'} Seat ${p.fridaySeat || '?'}${vipText}\n  Contact: ${p.contact}\n\n`;
                    });
                    text += '\n';
                });
            }
            
            const saturdayPeople = people.filter(p => p.nights === 'saturday' || p.nights === 'both');
            if (saturdayPeople.length > 0) {
                text += '\nSATURDAY, FEBRUARY 14\n' + '='.repeat(50) + '\n\n';
                const saturdaySections = {};
                saturdayPeople.forEach(p => {
                    if (!p.saturdaySection) return;
                    if (!saturdaySections[p.saturdaySection]) saturdaySections[p.saturdaySection] = [];
                    saturdaySections[p.saturdaySection].push(p);
                });
                Object.keys(saturdaySections).sort().forEach(sec => {
                    text += `SECTION ${sec}\n` + '-'.repeat(30) + '\n';
                    saturdaySections[sec].forEach(p => {
                        const vipText = p.saturdayVIP === 'soundcheck' ? ' - VIP Soundcheck' : p.saturdayVIP === 'bignight' ? ' - VIP Big Night Out' : '';
                        text += `${p.name} - Row ${p.saturdayRow || '?'} Seat ${p.saturdaySeat || '?'}${vipText}\n  Contact: ${p.contact}\n\n`;
                    });
                    text += '\n';
                });
            }
            copyToClipboard(text);
        }
        
        function exportHotels() {
            let text = 'üè® BRAMILY NYC - HOTEL LIST\n' + '='.repeat(50) + '\n\n';
            const hotels = {'springhill': [], 'courtyard': [], 'other': [], 'none': [], 'friends': []};
            people.forEach(p => { if (p.hotel && hotels[p.hotel]) hotels[p.hotel].push(p); });
            const hotelNames = {'springhill': 'SpringHill Suites by Marriott', 'courtyard': 'Courtyard by Marriott', 'other': 'Other Hotels', 'none': 'Not Staying Overnight', 'friends': 'Staying with Friends/Family'};
            Object.keys(hotels).forEach(key => {
                if (hotels[key].length === 0) return;
                text += `${hotelNames[key].toUpperCase()}\n` + '-'.repeat(30) + '\n';
                hotels[key].forEach(p => {
                    text += `${p.name}\n`;
                    if (p.checkin) text += `  Check-in: ${p.checkin}\n`;
                    if (p.checkout) text += `  Check-out: ${p.checkout}\n`;
                    text += `  Contact: ${p.contact}\n\n`;
                });
                text += '\n';
            });
            copyToClipboard(text);
        }
        
        function exportRideshare() {
            let text = 'üöó BRAMILY NYC - RIDESHARE BOARD\n' + '='.repeat(50) + '\n\n';
            const offering = people.filter(p => p.rideshare === 'offering');
            const looking = people.filter(p => p.rideshare === 'looking');
            if (offering.length > 0) {
                text += 'CAN COORDINATE SHARED RIDES\n' + '-'.repeat(30) + '\n';
                offering.forEach(p => {
                    text += `${p.name} - ${(p.airport || 'TBD').toUpperCase()}\n`;
                    if (p.arrivalDate && p.arrivalTime) text += `  Arrival: ${p.arrivalDate} ${p.arrivalTime}\n`;
                    if (p.departureDate && p.departureTime) text += `  Departure: ${p.departureDate} ${p.departureTime}\n`;
                    text += `  Contact: ${p.contact}\n\n`;
                });
                text += '\n';
            }
            if (looking.length > 0) {
                text += 'LOOKING TO JOIN SHARED RIDES\n' + '-'.repeat(30) + '\n';
                looking.forEach(p => {
                    text += `${p.name} - ${(p.airport || 'TBD').toUpperCase()}\n`;
                    if (p.arrivalDate && p.arrivalTime) text += `  Arrival: ${p.arrivalDate} ${p.arrivalTime}\n`;
                    if (p.departureDate && p.departureTime) text += `  Departure: ${p.departureDate} ${p.departureTime}\n`;
                    text += `  Contact: ${p.contact}\n\n`;
                });
            }
            copyToClipboard(text);
        }
        
        function exportAll() {
            let text = 'üìã BRAMILY NYC - COMPLETE DIRECTORY\nBrandi Carlile @ MSG ‚Ä¢ Feb 13-14, 2026\n' + '='.repeat(50) + '\n\n';
            const sorted = [...people].sort((a,b) => (a.name || '').localeCompare(b.name || ''));
            sorted.forEach(p => {
                text += `${p.name}\n`;
                if (p.nights === 'friday' || p.nights === 'both') {
                    text += `  Friday: Section ${p.fridaySection} ${p.fridayRow ? 'Row ' + p.fridayRow : ''} ${p.fridaySeat ? 'Seat ' + p.fridaySeat : ''}`;
                    if (p.fridayVIP !== 'none') text += ` (VIP: ${p.fridayVIP})`;
                    text += '\n';
                }
                if (p.nights === 'saturday' || p.nights === 'both') {
                    text += `  Saturday: Section ${p.saturdaySection} ${p.saturdayRow ? 'Row ' + p.saturdayRow : ''} ${p.saturdaySeat ? 'Seat ' + p.saturdaySeat : ''}`;
                    if (p.saturdayVIP !== 'none') text += ` (VIP: ${p.saturdayVIP})`;
                    text += '\n';
                }
                text += `  Hotel: ${p.hotel}\n  Contact: ${p.contact}\n`;
                if (p.notes) text += `  Notes: ${p.notes}\n`;
                text += '\n';
            });
            copyToClipboard(text);
        }
        
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('üìã Copied to clipboard!');
            }).catch(() => {
                alert(text);
            });
        }
        
        // Load data on page load
        loadData();
    </script>
</body>
</html>